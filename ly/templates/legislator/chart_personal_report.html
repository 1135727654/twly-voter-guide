<!--[if lt IE 10]>
<!DOCTYPE html>
<![endif]-->
{% extends "legislator/nav_base.html" %}
{% load staticfiles %}
{% load ly_extras %} 
{% block title %}
	{% if ly %}
		<title>立委投票指南:{{ly.name}}的個人圖表</title>
		<meta property="og:title" content="立委投票指南:{{ly.name}}的個人圖表"/>
		<meta itemprop="name" content="立委投票指南:{{ly.name}}的個人圖表">			
	{% else%}
		<title>立委投票指南:立委的個人圖表</title>
		<meta property="og:title" content="立委投票指南:立委的個人圖表"/>
		<meta itemprop="name" content="立委投票指南:立委的個人圖表">			
	{% endif %}
{% endblock %}
{% block left %} 
	 
{% endblock %}
{% block right %}
<div class="row-fluid">
	<div class="span3">
	<br>
		{% if ly %}
		<table class="table table-bordered">
		<tr><td style="background-color: lightgrey;">立委</td><td><b>{{ ly.name }}</b></td></tr>
		<tr><td style="background-color: lightgrey;">選區縣市</td><td><a href="{% url 'legislator:index_district' ly.district %}" rel="tooltip" title="查看該選區的立委" >{{ly.district}}</a></td></tr>
		{% if ly.districtDetail %}<tr><td style="background-color: lightgrey;">行政區</td><td><abbr title="{{ ly.districtDetail }}">{{ ly.districtDetail|truncatechars:10 }}</abbr></td></tr>{% endif %}
		<tr><td style="background-color: lightgrey;">現任委員會</td><td>{% if ly.enable %}<a href="{% url 'legislator:index_committee' ly.committee %}" >{{ ly.committee|truncatechars:7 }}</a>{% else %}已離職{% endif %}</td></tr>	<tr><td style="background-color: lightgrey;">到職日期</td><td>{{ ly.enabledate|date:"Y-m-d" }}</td>
		<tr><td style="background-color: lightgrey;">法條修正草案數</td><td>{{ ly.npribill }} 個</td></tr>
		<tr><td style="background-color: lightgrey;">附帶決議、臨時提案數</td><td>{{ ly.npriproposer }} 個</td></tr>
		<tr><td style="background-color: lightgrey;">沒投票表決(次)</td><td>{{ly.notvote}} 次</td></tr>
		<tr><td style="background-color: lightgrey;">脫黨表決(次)</td><td>{{ly.nconsciencevote}} 次</td></tr>
		<tr><td colspan=2></td></tr>
		<tr><td style="background-color: lightgrey;" rowspan=3>外部連結</td>
		{% if ly.facebook %}<td><a href={{ ly.facebook }} target="_blank">{{ ly.name }}的 Facebook</a></td></tr>{% endif %}
		{% if ly.wiki %}<td><a href={{ ly.wiki }} target="_blank">{{ ly.name }}的維基百科</a></td></tr>{% endif %}
		{% if ly.officialsite %}<td><a href={{ ly.officialsite }} target="_blank">{{ ly.name }}的立院官網</a></td></tr>{% endif %}
		</tr>
		</table>
		{% endif %}	
	</div>	
	<div class="span9">	
	<br>
	<div class="row-fluid">
		<div class="span12">
			<ul class="nav nav-pills">
			<li><b>{{ ly.name }}</b>的&nbsp;</li>
			<li><a class="btn" id='url_bill' href="{% url 'legislator:biller_detail' ly.id %}">法條修正草案</a></li>
			<li><a class="btn" id='url_proposal' href="{% url 'legislator:proposer_detail' ly.id %}">附帶決議、臨時提案</a></li>
			<li class="dropdown">
				<a id='url_vote' class="btn dropdown-toggle" href="{% url 'legislator:voter_detail' ly.id %}">投票紀錄 <b class="caret"></b></a>
				<ul class="dropdown-menu">
					<li><a href="{% url 'legislator:voter_detail' legislator_id=ly.id index='' %}" >全投票表決紀錄</a></li>
					<li><a href="{% url 'legislator:voter_detail' legislator_id=ly.id index='conscience' %}" >脫黨投票表決紀錄</a></li>
				</ul>				
			</li>	
			<li><a class="btn" id='url_pchart' href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='ly' %}">圖表</a></li>
			<li><a class="btn" id='url_politics' href="{% url 'legislator:ly_politics' ly.id %}">競選政見</a></li>
			</ul>
		</div>
	</div>
	<br>
		<div class="page-header">
			{% if ly %}
				{% if index == 'vote' %}
					<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='ly' %}" class="btn btn-large btn-info"><b>立法院開會</b><small>時間軸</small></a>
					<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='vote' %}" class="btn btn-large btn-danger"><b>立法院表決</b><small>時間軸</small></a>
					<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='proposal' %}" class="btn btn-large btn-info"><b>提案</b><small>時間軸</small></a>			
				{% elif index == 'proposal' %}
					<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='ly' %}" class="btn btn-large btn-info"><b>立法院開會</b><small>時間軸</small></a>
					<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='vote' %}" class="btn btn-large btn-info"><b>立法院表決</b><small>時間軸</small></a>
					<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='proposal' %}" class="btn btn-large btn-danger"><b>提案</b><small>時間軸</small></a>			
				{% else %}
					{% if index == 'ly' %}
						<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='ly' %}" class="btn btn-large btn-danger"><b>立法院開會</b><small>時間軸</small></a>
						<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='vote' %}" class="btn btn-large btn-info"><b>立法院表決</b><small>時間軸</small></a>
						<a href="{% url 'legislator:chart_personal_report' legislator_id=ly.id index='proposal' %}" class="btn btn-large btn-info"><b>提案</b><small>時間軸</small></a>			
					{% endif %}
				{% endif %}
			{% endif %}
			<br>
		</div>
		<div class="row-fluid">
			<div class="span9">
				<div class="hero-unit">
				<p class="lead text-center">
				{% if index == 'proposal' %}
					<font style="color: #FF9999;"><b>平均</b></font> <font style="color: #6699FF;"><b>個人</b>
				{% else %}
					<font style="color: #FF9999;"><b>應到</b></font> <font style="color: #6699FF;"><b>實到</b>
				{% endif %}
				</p>
				<canvas id="canvas" width="500" height="400" ></canvas>
				</div>
				<hr>	
			</div>
			<div class="span3">
				{% if obj %}
				<table class="table table-bordered" >
				<thead>
				<tr style="font-weight:bold;background-color: #CCFF99;">
				<th style="width: 50%">時間<br>(年 / 月)</th>
				<th style="width: 50%">
				{% if index == 'proposal' %}
					主提案<br>(個)
				{% elif index == 'ly' %}
					開會實到<br>(次)
				{% else %}
					{% if index == 'vote' %}
						表決實到<br>(次)
					{% endif %}
				{% endif %}		
				</th>
				</tr>
				</thead>
				<tbody>	
					{% for fragment in obj %}
						<tr style="background-color: {% cycle '#EEEEEE' 'white' %};">
						<td>{{fragment.year|floatformat:"0"}} / {{fragment.month|floatformat:"0"}}</td>
						<td>{{fragment.n}}</td>
						</tr>
					{% endfor %}
				</tbody>
				</table>
				{% else %}	
					<p class="lead text-warning">無相關紀錄</p>	
				{% endif %}
			</div>
		</div>
		<hr>
		<div class="fb-comments" data-width="480" data-num-posts="3" data-href={{current_url}}></div>			
	</div>	
</div>	
{% endblock %}
{% block script %}
<script src="https://s3-ap-northeast-1.amazonaws.com/twly.tw/Chart.js"></script>
<script>
$(document).ready( function() {
	$('#chart_report').addClass('active');
	$('#url_pchart').removeAttr('href').addClass("btn-success");	
	$('.dropdown-toggle').dropdown();
	$("[rel='tooltip']").tooltip();

});
var data = {
	{% if obj %}
		labels : [
			{% for fragment in obj %}
				"{{fragment.year|floatformat:"0"}}/{{fragment.month|floatformat:"0"}}",
			{% endfor %}
			],			
	{% endif %}
	datasets : [
		{% if compare_obj %}
		{
			fillColor : "rgba(255,204,204,0.5)",
			strokeColor : "rgba(255,204,204,1)",
			data : [							
					{% for fragment in compare_obj %}
						{% if index == 'proposal' %}
							{{fragment.id__count}}/113,
						{% else %}
							{{fragment.id__count}},
						{% endif %}
					{% endfor %}									
			]
		},
		{% endif %}	
		{
			fillColor : "rgba(151,187,205,0.5)",
			strokeColor : "rgba(151,187,205,1)",
			data : [			
				{% if obj %}
					{% for fragment in obj %}
						{{fragment.n}},
					{% endfor %}					
				{% endif %}
			]
		},

	]			
}

{% if obj %}
	var myLine = new Chart(document.getElementById("canvas").getContext("2d")).Line(data);
{% endif %}
</script>
{% endblock %}