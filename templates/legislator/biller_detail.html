<!--[if lt IE 10]>
<!DOCTYPE html>
<![endif]-->
{% extends "common/ly_info.html" %}
{% load ly_extras %} 
{% block title %}
    {% if ly %}
        <title>立委投票指南:{{ly.name}}的法條修正草案</title>
        <meta property="og:title" content="立委投票指南:{{ly.name}}的法條修正草案"/>
        <meta itemprop="name" content="立委投票指南:{{ly.name}}的法條修正草案">			
    {% else %}
        <title>立委投票指南:立委的法條修正草案</title>
        <meta property="og:title" content="立委投票指南:立委的法條修正草案"/>
        <meta itemprop="name" content="立委投票指南:立委的法條修正草案">
    {% endif %}
{% endblock title %}
{% block ly_detail %} 
    <form action="" method="get" class="form-search" id="form">
	{% csrf_token %}
	<br>
	<fieldset>
	    <select name="law" id="law">
	    <option selected="selected" disabled>選擇法案</option>
	    {% for fragment in laws %}
		<option style="background-color: {% cycle '#EEEEEE' 'white' %};">{{fragment.law}}</option>
	    {% endfor %}
	    </select>	
	    <input type="text" name="keyword" id="keyword" class="span5" maxlength="20" placeholder="例:勞工 居住...空格有交集效果">
	    <button type="submit" class="btn">Go!</button>
	    <label class="checkbox text-success" >
	    <input type="checkbox" name="proposertype" id="proposertype" {% if proposertype %} checked{% endif %}>要包含<b class="text-info">{{ly.name}}</b>不是<b class="text-info">主</b>提案人的草案嗎?
	    </label>
	    {% if error %}
	        <span class="help-inline"><a class="text-error">請輸入關鍵字!!</a></span>
	    {% endif %}
	</fieldset>
    </form>
    {% if keyword_obj %}
	<h4>熱門：
	{% for keyword in keyword_obj %}
	    {% if forloop.counter0 < 5 %}
		<a href="{% url 'legislator:biller_detail' legislator_id=ly.id keyword_url=keyword %}" rel="tooltip" title="包含此關鍵字的修正草案"><font style="color: {% cycle '#0099CC' '#009933' %};">{{keyword}}&nbsp;</font></a>
	    {% endif %}
	{% endfor %}
	</h4>
    {% endif %}	
    <div class="well well-small">
	<p class="lead">{{ly.name}}：
	{{ bills|length }}個
	{% if keyword %}
	    包含<font style="color: red;">"{{keyword}}"</font>的
	{% endif %}法條修正<small> 草案</small>
	</p>
    </div>
    {% if bills %}
        {% load pagination_tags %}
        {% autopaginate bills 10 %}
        {% paginate %}
        <table class="table table-bordered" >
            <thead>
                <tr style="font-weight:bold;background-color: #FFCCFF;">
                    <th style="text-align:center; vertical-align:middle; width: 18%">法案</th>
                    <th style="text-align:center; vertical-align:middle; width: 10%">主提案人</th>
                    <th style="text-align:center; vertical-align:middle; width: 36%">案由</th>
                    <th style="text-align:center; vertical-align:middle; width: 36%">說明</th>
            </thead>
            <tbody>	
            {% for fragment in bills %}
                <tr style="background-color: {% cycle '#EEEEEE' 'white' %};">
                    <td style="vertical-align:middle;"><a href="{% url 'bill:bill_detail' bill_id=fragment.billid proposal_id=fragment.proposalid %}" rel="tooltip" title="法條對照表">{{ fragment.title }}</a></td>
                    <td style="text-align:center; vertical-align:middle;">{{ fragment.primary_proposer.0.name }}</td>
                    {% if keyword %}
                        <td>{{fragment.motivation|linebreaksbr|replace:keyword|safe}}</td>
                        <td>{{fragment.description|linebreaksbr|replace:keyword|safe}}</td>
                    {% else %}
                        <td><abbr title="{{ fragment.motivation }}">{{fragment.motivation|linebreaksbr|truncatechars:80}}</td></abbr>
                        <td><abbr title="{{ fragment.description }}">{{fragment.description|linebreaksbr|truncatechars:80}}</td></abbr>
                    {% endif %}
                </tr>
            {% empty %}
                <p>完全沒有法案</p>
            {% endfor %}
            </tbody>	
        </table>
        {% paginate %}		
    {% else %}
        <p class="text-error">完全沒有草案</p>
    {% endif %}
{% endblock ly_detail %}
{% block script %}
    <script>
    $(document).ready( function() {
	$('#url_bill').removeAttr('href').addClass("btn-inverse");
	$('#proposertype').change(function() {
	    $("#form").trigger('submit');
	});
	$('#law').change(function() {
	    $("#form").trigger('submit');
	});		
    });
    </script>
    {{ block.super }}
{% endblock script %}
